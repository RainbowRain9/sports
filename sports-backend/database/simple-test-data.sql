-- =============================================
-- 简化版测试数据脚本 - 数据统计中心
-- =============================================

USE sports;

-- 1. 添加更多运动员数据
INSERT INTO `player` (`player_name`, `player_sex`, `player_birthday`, `player_class`, `player_studentid`, `player_number`, `player_username`, `player_password`, `player_status`) VALUES
('张伟', '男', '2003-03-15', '计算机2301', '2023001001', '101', '2023001001', '123456', 1),
('李娜', '女', '2003-05-20', '计算机2301', '2023001002', '102', '2023001002', '123456', 1),
('王强', '男', '2003-07-10', '计算机2301', '2023001003', '103', '2023001003', '123456', 1),
('刘敏', '女', '2003-09-25', '计算机2301', '2023001004', '104', '2023001004', '123456', 1),
('陈浩', '男', '2003-11-08', '计算机2301', '2023001005', '105', '2023001005', '123456', 1),
('杨丽', '女', '2003-01-30', '计算机2302', '2023001006', '106', '2023001006', '123456', 1),
('赵磊', '男', '2003-04-12', '计算机2302', '2023001007', '107', '2023001007', '123456', 1),
('孙雪', '女', '2003-06-18', '计算机2302', '2023001008', '108', '2023001008', '123456', 1),
('周杰', '男', '2003-08-22', '计算机2302', '2023001009', '109', '2023001009', '123456', 1),
('吴琳', '女', '2003-10-05', '计算机2302', '2023001010', '110', '2023001010', '123456', 1),
('郑斌', '男', '2003-02-14', '软件2301', '2023002001', '111', '2023002001', '123456', 1),
('何静', '女', '2003-04-28', '软件2301', '2023002002', '112', '2023002002', '123456', 1),
('冯涛', '男', '2003-06-16', '软件2301', '2023002003', '113', '2023002003', '123456', 1),
('蒋萍', '女', '2003-08-09', '软件2301', '2023002004', '114', '2023002004', '123456', 1),
('韩旭', '男', '2003-10-23', '软件2301', '2023002005', '115', '2023002005', '123456', 1),
('曹颖', '女', '2003-12-11', '软件2302', '2023002006', '116', '2023002006', '123456', 1),
('邓勇', '男', '2003-01-07', '软件2302', '2023002007', '117', '2023002007', '123456', 1),
('许芳', '女', '2003-03-21', '软件2302', '2023002008', '118', '2023002008', '123456', 1),
('方明', '男', '2003-05-13', '软件2302', '2023002009', '119', '2023002009', '123456', 1),
('石莉', '女', '2003-07-26', '软件2302', '2023002010', '120', '2023002010', '123456', 1),
('姚鹏', '男', '2003-09-03', '信息2301', '2023003001', '121', '2023003001', '123456', 1),
('谭红', '女', '2003-11-17', '信息2301', '2023003002', '122', '2023003002', '123456', 1),
('廖刚', '男', '2003-01-24', '信息2301', '2023003003', '123', '2023003003', '123456', 1),
('钟梅', '女', '2003-03-08', '信息2301', '2023003004', '124', '2023003004', '123456', 1),
('薛亮', '男', '2003-05-19', '信息2301', '2023003005', '125', '2023003005', '123456', 1),
('雷娟', '女', '2003-07-02', '信息2302', '2023003006', '126', '2023003006', '123456', 1),
('贺军', '男', '2003-08-15', '信息2302', '2023003007', '127', '2023003007', '123456', 1),
('龚玲', '女', '2003-10-28', '信息2302', '2023003008', '128', '2023003008', '123456', 1),
('段辉', '男', '2003-12-06', '信息2302', '2023003009', '129', '2023003009', '123456', 1),
('卢艳', '女', '2003-02-19', '信息2302', '2023003010', '130', '2023003010', '123456', 1);

-- 2. 添加报名记录
INSERT INTO `registration` (`player_id`, `schedule_id`, `registration_status`, `admin_id`, `admin_note`) VALUES
-- 跳远项目报名
(17, 11, 2, 5, '审核通过'),
(18, 11, 2, 5, '审核通过'),
(19, 11, 2, 5, '审核通过'),
(20, 11, 2, 5, '审核通过'),
(21, 11, 2, 5, '审核通过'),
(22, 11, 2, 5, '审核通过'),
(23, 11, 2, 5, '审核通过'),
(24, 11, 2, 5, '审核通过'),
(25, 11, 2, 5, '审核通过'),
(26, 11, 2, 5, '审核通过'),
-- 1000米项目报名
(27, 14, 2, 5, '审核通过'),
(28, 14, 2, 5, '审核通过'),
(29, 14, 2, 5, '审核通过'),
(30, 14, 2, 5, '审核通过'),
(31, 14, 2, 5, '审核通过'),
(32, 14, 2, 5, '审核通过'),
(33, 14, 2, 5, '审核通过'),
(34, 14, 2, 5, '审核通过'),
(35, 14, 2, 5, '审核通过'),
(36, 14, 2, 5, '审核通过'),
-- 铅球项目报名
(37, 17, 2, 5, '审核通过'),
(38, 17, 2, 5, '审核通过'),
(39, 17, 2, 5, '审核通过'),
(40, 17, 2, 5, '审核通过'),
(41, 17, 2, 5, '审核通过'),
(42, 17, 2, 5, '审核通过'),
(43, 17, 2, 5, '审核通过'),
(44, 17, 2, 5, '审核通过'),
-- 待审核的报名
(45, 11, 1, NULL, NULL),
(46, 14, 1, NULL, NULL);

-- 3. 添加成绩记录
INSERT INTO `plog` (`plog_playerid`, `plog_scheduleid`, `plog_score`, `plog_adminid`) VALUES
-- 跳远成绩 (单位：厘米)
(17, 11, 650, 5),
(18, 11, 680, 5),
(19, 11, 720, 5),
(20, 11, 695, 5),
(21, 11, 710, 5),
(22, 11, 665, 5),
(23, 11, 690, 5),
(24, 11, 705, 5),
(25, 11, 675, 5),
(26, 11, 685, 5),
-- 1000米成绩 (单位：秒)
(27, 14, 195, 5),
(28, 14, 188, 5),
(29, 14, 202, 5),
(30, 14, 185, 5),
(31, 14, 198, 5),
(32, 14, 192, 5),
(33, 14, 205, 5),
(34, 14, 190, 5),
(35, 14, 200, 5),
(36, 14, 187, 5),
-- 铅球成绩 (单位：厘米)
(37, 17, 1250, 5),
(38, 17, 1180, 5),
(39, 17, 1320, 5),
(40, 17, 1290, 5),
(41, 17, 1210, 5),
(42, 17, 1270, 5),
(43, 17, 1195, 5),
(44, 17, 1305, 5);

-- 4. 创建统计视图
CREATE OR REPLACE VIEW `v_statistics_overview` AS
SELECT 
  (SELECT COUNT(*) FROM player WHERE player_status = 1) as total_players,
  (SELECT COUNT(*) FROM admin WHERE admin_type = '2') as total_admins,
  (SELECT COUNT(*) FROM competition) as total_events,
  (SELECT COUNT(*) FROM registration WHERE registration_status = 1) as pending_registrations,
  (SELECT COUNT(*) FROM registration WHERE registration_status = 2) as approved_registrations,
  (SELECT COUNT(*) FROM plog) as total_scores,
  (SELECT COUNT(DISTINCT player_id) FROM registration WHERE registration_status = 2) as participating_players;

-- 5. 班级统计视图
CREATE OR REPLACE VIEW `v_class_stats` AS
SELECT 
  player_class,
  COUNT(*) as student_count,
  COUNT(CASE WHEN player_sex = '男' THEN 1 END) as male_count,
  COUNT(CASE WHEN player_sex = '女' THEN 1 END) as female_count
FROM player 
WHERE player_status = 1
GROUP BY player_class
ORDER BY student_count DESC;

-- 6. 项目参与统计视图
CREATE OR REPLACE VIEW `v_event_stats` AS
SELECT 
  c.schedule_name,
  p.type_name,
  COUNT(r.registration_id) as registration_count,
  COUNT(CASE WHEN r.registration_status = 2 THEN 1 END) as approved_count,
  COUNT(pl.plog_id) as score_count
FROM competition c
LEFT JOIN project p ON c.schedule_itemid = p.type_id
LEFT JOIN registration r ON c.schedule_id = r.schedule_id
LEFT JOIN plog pl ON c.schedule_id = pl.plog_scheduleid
GROUP BY c.schedule_id, c.schedule_name, p.type_name
ORDER BY registration_count DESC;

SELECT 'Simple test data created successfully!' as message;
